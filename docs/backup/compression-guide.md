# ë°±ì—… ì••ì¶• ê°€ì´ë“œ

## ê°œìš”

ë°±ì—… ì‹œìŠ¤í…œì€ **gzip ì••ì¶•**ì„ ì‚¬ìš©í•˜ì—¬ ë°±ì—… íŒŒì¼ì˜ í¬ê¸°ë¥¼ 70-90% ì¤„ì…ë‹ˆë‹¤. ì´ëŠ” íŠ¹íˆ ì œí•œëœ ìŠ¤í† ë¦¬ì§€ í™˜ê²½ì—ì„œ ë§¤ìš° ìœ ìš©í•©ë‹ˆë‹¤.

---

## ì••ì¶•ì˜ ì¥ì 

### ğŸ’° ë¹„ìš© ì ˆê°

**ì••ì¶• íš¨ê³¼ ì˜ˆì‹œ** (ì‹¤ì œ ë°ì´í„° ê¸°ì¤€):

| ì›ë³¸ SQL í¬ê¸° | ì••ì¶• í›„ í¬ê¸° | ì ˆê°ë¥  | ë””ìŠ¤í¬ ì ˆì•½ |
|--------------|-------------|--------|------------|
| 100 MB | 10-30 MB | 70-90% | 70-90 MB |
| 500 MB | 50-150 MB | 70-90% | 350-450 MB |
| 1 GB | 100-300 MB | 70-90% | 700-900 MB |
| 10 GB | 1-3 GB | 70-90% | 7-9 GB |

**EC2 ìŠ¤í† ë¦¬ì§€ ë¹„ìš© ê³„ì‚°**:
- EC2 EBS gp3: ì•½ $0.08/GB/ì›”
- 10GB ë°±ì—… â†’ ì••ì¶• ì‹œ 1-3GB
- ì›”ê°„ ì ˆê°: $0.56-$0.72 (7-9GB Ã— $0.08)
- ì—°ê°„ ì ˆê°: $6.72-$8.64

### âš¡ ì„±ëŠ¥ í–¥ìƒ

1. **ë°±ì—… ì†ë„ ê°œì„ **
   - ë””ìŠ¤í¬ I/O ê°ì†Œ
   - ë„¤íŠ¸ì›Œí¬ ì „ì†¡ ì‹œê°„ ë‹¨ì¶• (ì›ê²© ë°±ì—… ì‹œ)

2. **ë³µêµ¬ ì†ë„**
   - ì‘ì€ íŒŒì¼ í¬ê¸°ë¡œ ë¹ ë¥¸ ì „ì†¡
   - CPU ì••ì¶• í•´ì œëŠ” ë§¤ìš° ë¹ ë¦„ (ì´ˆ ë‹¨ìœ„)

### ğŸ”’ ë³´ì•ˆ

- ì••ì¶•ëœ íŒŒì¼ì€ ì¶”ê°€ ì•”í˜¸í™” ì ìš© ê°€ëŠ¥
- ë°”ì´ë„ˆë¦¬ í˜•ì‹ìœ¼ë¡œ ì¸í•œ ê¸°ë³¸ì ì¸ ë‚œë…í™”

---

## ì••ì¶• ì„¤ì •

### í™˜ê²½ë³€ìˆ˜

`.env` íŒŒì¼ì—ì„œ ì••ì¶•ì„ ì œì–´í•©ë‹ˆë‹¤:

```bash
# ì••ì¶• í™œì„±í™” (ê¸°ë³¸ê°’, ê¶Œì¥)
BACKUP_COMPRESS=true

# ì••ì¶• ë¹„í™œì„±í™” (ë””ë²„ê¹…ìš©)
BACKUP_COMPRESS=false
```

### ì„¤ì • ë³€ê²½ í›„ ì¬ì‹œì‘

```bash
# ì• í”Œë¦¬ì¼€ì´ì…˜ ì¬ì‹œì‘
npm run start:dev

# ë˜ëŠ” í”„ë¡œë•ì…˜ì—ì„œ
pm2 restart lumir-cms-backend
```

---

## ì••ì¶• íŒŒì¼ ë‹¤ë£¨ê¸°

### ì••ì¶• íŒŒì¼ í™•ì¸

```bash
# íŒŒì¼ í¬ê¸° í™•ì¸
ls -lh ./backups/database/daily/

# ì••ì¶•ë¥  í™•ì¸
gzip -l backup_daily_20260121_010000.sql.gz

# ì¶œë ¥ ì˜ˆì‹œ:
#   compressed  uncompressed  ratio  uncompressed_name
#      2621440      10485760  75.0%  backup_daily_20260121_010000.sql
```

### ì••ì¶• í•´ì œ

#### Linux/Mac

```bash
# ì••ì¶• í•´ì œ (ì›ë³¸ íŒŒì¼ ìƒì„±)
gunzip backup_daily_20260121_010000.sql.gz
# ê²°ê³¼: backup_daily_20260121_010000.sql

# ì••ì¶• íŒŒì¼ ìœ ì§€í•˜ë©´ì„œ í•´ì œ
gunzip -k backup_daily_20260121_010000.sql.gz

# í‘œì¤€ ì¶œë ¥ìœ¼ë¡œ ì••ì¶• í•´ì œ (íŒŒì¼ ìƒì„± ì•ˆ í•¨)
gunzip -c backup_daily_20260121_010000.sql.gz > backup.sql
```

#### Windows

**ë°©ë²• 1: 7-Zip ì‚¬ìš© (ê¶Œì¥)**

```powershell
# 7-Zip ì„¤ì¹˜ (https://www.7-zip.org/)
# GUI: íŒŒì¼ ìš°í´ë¦­ > 7-Zip > Extract Here

# ëª…ë ¹ì¤„:
7z x backup_daily_20260121_010000.sql.gz
```

**ë°©ë²• 2: Git Bash**

```bash
# Git Bash í„°ë¯¸ë„ì—ì„œ
gunzip backup_daily_20260121_010000.sql.gz
```

**ë°©ë²• 3: PowerShell 7+ (ë‚´ì¥)**

```powershell
# PowerShell 7 ì´ìƒ
tar -xzf backup_daily_20260121_010000.sql.gz
```

### ë‚´ìš© ë¯¸ë¦¬ë³´ê¸°

```bash
# ì••ì¶• íŒŒì¼ì˜ ì²˜ìŒ 100ì¤„ í™•ì¸
gunzip -c backup_daily_20260121_010000.sql.gz | head -n 100

# íŠ¹ì • í…Œì´ë¸” ê²€ìƒ‰
gunzip -c backup_daily_20260121_010000.sql.gz | grep "CREATE TABLE users"
```

---

## ë³µêµ¬ ë°©ë²•

### ì§ì ‘ ë³µêµ¬ (ê¶Œì¥)

ì••ì¶• í•´ì œì™€ ë³µêµ¬ë¥¼ ë™ì‹œì— ìˆ˜í–‰:

```bash
# Linux/Mac
gunzip -c backup_daily_20260121_010000.sql.gz | \
  PGPASSWORD="password" psql -h localhost -U postgres -d lumir_cms

# Windows (Git Bash)
gunzip -c backup_daily_20260121_010000.sql.gz | \
  PGPASSWORD="password" psql -h localhost -U postgres -d lumir_cms
```

### 2ë‹¨ê³„ ë³µêµ¬

ì••ì¶• í•´ì œ í›„ ë³µêµ¬:

```bash
# 1. ì••ì¶• í•´ì œ
gunzip backup_daily_20260121_010000.sql.gz

# 2. ë³µêµ¬
psql -h localhost -U postgres -d lumir_cms -f backup_daily_20260121_010000.sql

# 3. ì •ë¦¬ (ì„ íƒì‚¬í•­)
rm backup_daily_20260121_010000.sql
```

---

## ì••ì¶• ë¹„í™œì„±í™” (ë””ë²„ê¹…ìš©)

### ì–¸ì œ ë¹„í™œì„±í™”í•˜ë‚˜ìš”?

ì••ì¶•ì„ ë¹„í™œì„±í™”í•˜ëŠ” ê²½ìš°:
- ë°±ì—… íŒŒì¼ ë‚´ìš©ì„ ì§ì ‘ í™•ì¸í•´ì•¼ í•  ë•Œ
- ê°œë°œ/í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ë””ë²„ê¹… ì‹œ
- ì••ì¶• í•´ì œ ë„êµ¬ê°€ ì—†ëŠ” í™˜ê²½

### ë¹„í™œì„±í™” ë°©ë²•

```bash
# .env íŒŒì¼ ìˆ˜ì •
BACKUP_COMPRESS=false
```

### ì£¼ì˜ì‚¬í•­

âš ï¸ **í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ê¶Œì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤**:
- ë””ìŠ¤í¬ ê³µê°„ì„ 10ë°° ë” ì‚¬ìš©
- ë°±ì—… íŒŒì¼ í¬ê¸°ê°€ ë§¤ìš° ì»¤ì§
- EC2 ìŠ¤í† ë¦¬ì§€ ë¹„ìš© ì¦ê°€

---

## ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§

### ë°±ì—… ë””ë ‰í† ë¦¬ í¬ê¸° í™•ì¸

```bash
# ì „ì²´ ë°±ì—… í¬ê¸°
du -sh ./backups/database

# íƒ€ì…ë³„ í¬ê¸°
du -sh ./backups/database/*

# ì¶œë ¥ ì˜ˆì‹œ:
# 256M    ./backups/database/daily
# 128M    ./backups/database/four_hourly
# 512M    ./backups/database/monthly
# 1.2G    ./backups/database/quarterly
# 64M     ./backups/database/weekly
# 2.5G    ./backups/database/yearly
```

### ìë™ ì•Œë¦¼ ì„¤ì •

ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ì´ 80%ë¥¼ ì´ˆê³¼í•˜ë©´ ì•Œë¦¼:

```bash
# crontabì— ì¶”ê°€
*/30 * * * * /scripts/check-disk-space.sh

# /scripts/check-disk-space.sh ë‚´ìš©:
#!/bin/bash
USAGE=$(df -h /backups | awk 'NR==2 {print $5}' | sed 's/%//')
if [ $USAGE -gt 80 ]; then
  echo "âš ï¸ ë°±ì—… ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰: ${USAGE}%" | mail -s "ë°±ì—… ë””ìŠ¤í¬ ì•Œë¦¼" admin@example.com
fi
```

---

## FAQ

### Q: ì••ì¶•ìœ¼ë¡œ ì¸í•œ ì„±ëŠ¥ ì €í•˜ëŠ” ì—†ë‚˜ìš”?

A: **ê±°ì˜ ì—†ìŠµë‹ˆë‹¤**. gzip ì••ì¶•ì€:
- CPU ì‚¬ìš©ëŸ‰: ë§¤ìš° ë‚®ìŒ (ë°±ì—… ì¤‘ 5-10% ì¦ê°€)
- ë°±ì—… ì‹œê°„: ì˜¤íˆë ¤ ê°ì†Œ (I/O ë³‘ëª© ê°ì†Œ)
- ì „ì²´ ì‹œìŠ¤í…œ ì„±ëŠ¥ì— ì˜í–¥ ì—†ìŒ

### Q: ì••ì¶•ë¥ ì€ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?

A: SQL íŒŒì¼ì€ í…ìŠ¤íŠ¸ í˜•ì‹ì´ë¼ **í‰ê·  70-90%** ì••ì¶•ë©ë‹ˆë‹¤:
- ë°˜ë³µë˜ëŠ” SQL êµ¬ë¬¸ (INSERT INTO...)
- ê¸´ ê³µë°±ê³¼ ë“¤ì—¬ì“°ê¸°
- ìœ ì‚¬í•œ ë°ì´í„° íŒ¨í„´

### Q: ì••ì¶• í•´ì œì— ì˜¤ë˜ ê±¸ë¦¬ë‚˜ìš”?

A: **ë§¤ìš° ë¹ ë¦…ë‹ˆë‹¤**:
- 1GB ì••ì¶• íŒŒì¼: ì•½ 5-10ì´ˆ
- 10GB ì••ì¶• íŒŒì¼: ì•½ 30-60ì´ˆ
- ë””ìŠ¤í¬ I/Oê°€ ì£¼ìš” ë³‘ëª©

### Q: ì••ì¶•ëœ íŒŒì¼ì„ ì§ì ‘ í™•ì¸í•  ìˆ˜ ìˆë‚˜ìš”?

A: ë„¤, `gunzip -c`ë¡œ ê°€ëŠ¥í•©ë‹ˆë‹¤:
```bash
# ì²˜ìŒ 100ì¤„ í™•ì¸
gunzip -c backup.sql.gz | head -n 100

# íŠ¹ì • íŒ¨í„´ ê²€ìƒ‰
gunzip -c backup.sql.gz | grep "users"
```

### Q: Windowsì—ì„œ gunzipì„ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ”ë°ìš”?

A: 3ê°€ì§€ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤:
1. **7-Zip** ì„¤ì¹˜ (ê¶Œì¥)
2. **Git Bash** ì‚¬ìš© (git ì„¤ì¹˜ ì‹œ í¬í•¨)
3. **PowerShell 7+** ì‚¬ìš© (`tar -xzf`)

### Q: ì••ì¶•ì„ ë‚˜ì¤‘ì— í™œì„±í™”í•  ìˆ˜ ìˆë‚˜ìš”?

A: ë„¤, ì–¸ì œë“ ì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤:
- ê¸°ì¡´ ë°±ì—…: ì••ì¶•ë˜ì§€ ì•Šì€ `.sql` íŒŒì¼ë¡œ ìœ ì§€
- ìƒˆ ë°±ì—…: ì••ì¶•ëœ `.sql.gz` íŒŒì¼ë¡œ ìƒì„±
- ë‘ í˜•ì‹ ëª¨ë‘ ë³µêµ¬ ê°€ëŠ¥

---

## ëª¨ë²” ì‚¬ë¡€

### âœ… ê¶Œì¥ì‚¬í•­

1. **í”„ë¡œë•ì…˜ì—ì„œëŠ” í•­ìƒ ì••ì¶• í™œì„±í™”**
   ```bash
   BACKUP_COMPRESS=true
   ```

2. **ì •ê¸°ì ì¸ ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§**
   ```bash
   # ë§¤ì£¼ ì›”ìš”ì¼ ë°±ì—… í¬ê¸° í™•ì¸
   crontab: 0 9 * * 1 du -sh /backups/database | mail -s "ë°±ì—… í¬ê¸°" admin@example.com
   ```

3. **ì••ì¶• íŒŒì¼ ì§ì ‘ ë³µêµ¬**
   ```bash
   # ì„ì‹œ íŒŒì¼ ìƒì„± ì—†ì´ ë°”ë¡œ ë³µêµ¬
   gunzip -c backup.sql.gz | psql -d database
   ```

4. **ë³µêµ¬ í…ŒìŠ¤íŠ¸**
   ```bash
   # ì›” 1íšŒ ë³µêµ¬ í…ŒìŠ¤íŠ¸
   createdb test_restore
   gunzip -c latest_backup.sql.gz | psql -d test_restore
   dropdb test_restore
   ```

### âŒ í”¼í•´ì•¼ í•  ì‚¬í•­

1. **í”„ë¡œë•ì…˜ì—ì„œ ì••ì¶• ë¹„í™œì„±í™”**
   - ë””ìŠ¤í¬ ê³µê°„ ë¶€ì¡± ìœ„í—˜
   - ë†’ì€ ìŠ¤í† ë¦¬ì§€ ë¹„ìš©

2. **ì••ì¶• íŒŒì¼ì„ ìˆ˜ë™ìœ¼ë¡œ í¸ì§‘**
   - íŒŒì¼ ì†ìƒ ìœ„í—˜
   - ì••ì¶• í•´ì œ â†’ í¸ì§‘ â†’ ì¬ì••ì¶• ê¶Œì¥

3. **ì••ì¶• í•´ì œ í›„ ì›ë³¸ ì‚­ì œ**
   ```bash
   # ì˜ëª»ëœ ë°©ë²•
   gunzip backup.sql.gz  # ì›ë³¸ ì‚­ì œë¨
   
   # ì˜¬ë°”ë¥¸ ë°©ë²•
   gunzip -k backup.sql.gz  # ì›ë³¸ ìœ ì§€
   ```

---

## ê´€ë ¨ ë¬¸ì„œ

- [ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… ê°€ì´ë“œ](./database-backup-guide.md)
- [SQL ë³µêµ¬ ê°€ì´ë“œ](./sql-restore-guide.md)
- [TypeORM ë°±ì—…ì˜ ì¥ì ](./typeorm-backup-benefits.md)

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2026-01-21  
**ë²„ì „**: 2.0.0 (gzip ì••ì¶• ì§€ì›)
