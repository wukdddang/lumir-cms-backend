---
alwaysApply: true
---

# 루미르 CMS 엔티티 정의

## 구현 위치 매핑

- **공통 타입**: `src/domain/core/common/types/`
- **Core Domain**: `src/domain/core/`
- **Sub Domain**: `src/domain/sub/`
- **공통 도메인**: `src/domain/common/`

---

## 공통 엔티티 (Common Entities)

### Language (언어)

**파일 위치**: `src/domain/common/language/`

```typescript
enum LanguageCode {
  KOREAN = 'ko',
  ENGLISH = 'en',
  JAPANESE = 'ja',
  CHINESE = 'zh',
}

interface LanguageEntity extends BaseEntity {
  code: LanguageCode;
  name: string; // 예: 한국어, English
  isActive: boolean; // 활성화 여부
}
```

**구현 파일**:

- `language.entity.ts` - TypeORM Entity
- `language.types.ts` - DTO 타입 정의
- `language.service.ts` - Domain Service
- `language.module.ts` - NestJS Module

### Attachment (첨부파일)

**파일 위치**: `src/domain/common/attachment/`

```typescript
// 첨부파일이 속한 엔티티 타입
enum AttachmentEntityType {
  MAIN_POPUP = 'main_popup',
  SHAREHOLDERS_MEETING = 'shareholders_meeting',
  ANNOUNCEMENT = 'announcement',
  EDUCATION_MANAGEMENT = 'education_management',
  ELECTRONIC_DISCLOSURE = 'electronic_disclosure',
  IR = 'ir',
  BROCHURE = 'brochure',
  LUMIR_STORY = 'lumir_story',
  VIDEO_GALLERY = 'video_gallery',
  NEWS = 'news',
  SURVEY = 'survey',
}

interface AttachmentEntity extends BaseEntity {
  entityType: AttachmentEntityType; // 어느 엔티티의 첨부파일인지
  entityId: string; // 해당 엔티티의 ID
  fileName: string; // 원본 파일명
  fileSize: number; // 파일 크기 (bytes)
  mimeType: string; // MIME 타입 (예: image/jpeg, application/pdf)
  url: string; // AWS S3 URL
  order: number; // 첨부파일 순서
}
```

**구현 파일**:

- `attachment.entity.ts` - TypeORM Entity
- `attachment.types.ts` - DTO 타입 정의
- `attachment.service.ts` - Domain Service
- `attachment.module.ts` - NestJS Module

### Category (카테고리)

**파일 위치**: `src/domain/common/category/`

```typescript
enum CategoryEntityType {
  ANNOUNCEMENT = 'announcement',
  MAIN_POPUP = 'main_popup',
  SHAREHOLDERS_MEETING = 'shareholders_meeting',
  ELECTRONIC_DISCLOSURE = 'electronic_disclosure',
  IR = 'ir',
  BROCHURE = 'brochure',
  LUMIR_STORY = 'lumir_story',
  VIDEO_GALLERY = 'video_gallery',
  NEWS = 'news',
  SURVEY = 'survey',
}

interface CategoryEntity extends BaseEntity {
  entityType: CategoryEntityType; // 어느 도메인의 카테고리인지
  name: string;
  description: string;
  isActive: boolean; // 활성화 여부
  order: number; // 정렬 순서
}
```

**구현 파일**:

- `category.entity.ts` - TypeORM Entity
- `category.types.ts` - DTO 타입 정의
- `category.service.ts` - Domain Service
- `category.module.ts` - NestJS Module

### CategoryMapping (카테고리 매핑 중간 테이블)

**파일 위치**: `src/domain/common/category-mapping/`

```typescript
interface CategoryMappingEntity extends BaseEntity {
  entityType: CategoryEntityType; // 어느 엔티티의 카테고리인지 (성능 최적화용)
  entityId: string; // 엔티티 ID
  categoryId: string; // Category 엔티티 참조
  // 유니크 제약조건: (entityType, entityId, categoryId) - 같은 엔티티가 같은 카테고리를 중복으로 가질 수 없음
}
```

**구현 파일**:

- `category-mapping.entity.ts` - TypeORM Entity
- `category-mapping.types.ts` - DTO 타입 정의
- `category-mapping.service.ts` - Domain Service
- `category-mapping.module.ts` - NestJS Module

### ContentStatus (콘텐츠 상태)

**파일 위치**: `src/domain/core/common/types/status.types.ts`

```typescript
enum ContentStatus {
  DRAFT = 'draft', // 초안
  APPROVED = 'approved', // 승인됨
  UNDER_REVIEW = 'under_review', // 검토중
  REJECTED = 'rejected', // 거부됨
  OPENED = 'opened', // 공개됨
}

// 별칭 타입들
type AnnouncementStatus = ContentStatus;
type ElectronicDisclosureStatus = ContentStatus;
type IRStatus = ContentStatus;
type BrochureStatus = ContentStatus;
type LumirStoryStatus = ContentStatus;
type VideoGalleryStatus = ContentStatus;
type NewsStatus = ContentStatus;
type SurveyStatus = ContentStatus;
```

### BaseEntity (기본 엔티티)

**파일 위치**: `libs/database/base/base.entity.ts`

```typescript
abstract class BaseEntity<T> {
  id: string; // UUID
  createdAt: Date; // 생성 일시
  updatedAt: Date; // 수정 일시
  deletedAt?: Date | null; // 삭제 일시 (Soft Delete)
  createdBy?: string; // 생성자 ID (외부 시스템 직원 ID - SSO)
  updatedBy?: string; // 수정자 ID (외부 시스템 직원 ID - SSO)
  version: number; // 낙관적 락 버전

  abstract DTO로_변환한다(): T;
}
```

---

## Core Domain (핵심 비즈니스)

### 1. MainPopup (메인 팝업)

**파일 위치**: `src/domain/core/main-popup/`

```typescript
interface MainPopupEntity extends BaseEntity {
  status: ContentStatus;
  isPublic: boolean;
  releasedAt?: Date; // Date 타입으로 수정
  imageUrl?: string; // AWS S3 URL (팝업 이미지)
  order: number; // 정렬 순서
  // categories는 CategoryMapping 중간 테이블로 관리
  // attachments는 Attachment 테이블로 관리 (entityType = 'main_popup')
  // translations는 MainPopupTranslation 테이블로 관리
}

// 언어별 번역
interface MainPopupTranslationEntity extends BaseEntity {
  mainPopupId: string; // MainPopup 엔티티 참조
  languageId: string; // Language 엔티티 참조
  title: string;
  description: string; // 설명
}
```

**구현 파일**:

- `main-popup.entity.ts` - TypeORM Entity
- `main-popup-translation.entity.ts` - TypeORM Translation Entity
- `main-popup.types.ts` - DTO 타입 정의
- `main-popup.service.ts` - Domain Service
- `main-popup.module.ts` - NestJS Module

### 2. ShareholdersMeeting (주주총회)

**파일 위치**: `src/domain/core/shareholders-meeting/`

```typescript
// 의결 결과 (독립 테이블)
interface VoteResultEntity extends BaseEntity {
  shareholdersMeetingId: string; // ShareholdersMeeting 엔티티 참조
  agendaNumber: number; // 안건 번호 (예: 1, 2, 3)
  totalVote: number;
  yesVote: number;
  noVote: number;
  approvalRating: number; // 찬성률 (%)
  result: 'accepted' | 'rejected';
  order: number; // 안건 순서
  // translations는 VoteResultTranslation 테이블로 관리
}

// 의결 결과 언어별 번역
interface VoteResultTranslationEntity extends BaseEntity {
  voteResultId: string; // VoteResult 엔티티 참조
  languageId: string; // Language 엔티티 참조
  title: string; // 안건 제목
}

interface ShareholdersMeetingEntity extends BaseEntity {
  isPublic: boolean;
  location: string;
  meetingDate: Date; // Date 타입
  releasedAt?: Date; // Date 타입
  order: number; // 정렬 순서
  // categories는 CategoryMapping 중간 테이블로 관리
  // attachments는 Attachment 테이블로 관리 (entityType = 'shareholders_meeting')
  // translations는 ShareholdersMeetingTranslation 테이블로 관리
  // voteResults는 VoteResult 테이블로 관리 (1:N 관계)
}

// 언어별 번역
interface ShareholdersMeetingTranslationEntity extends BaseEntity {
  shareholdersMeetingId: string; // ShareholdersMeeting 엔티티 참조
  languageId: string; // Language 엔티티 참조
  title: string;
  description: string; // 간단한 설명
  content: string; // 상세 내용
  resultText: string; // 의결 결과 텍스트
  summary: string; // 요약
}
```

**구현 파일**:

- `vote-result.entity.ts` - 의결 결과 엔티티 (독립 테이블)
- `vote-result-translation.entity.ts` - 의결 결과 번역 엔티티
- `vote-result.types.ts` - 의결 결과 타입
- `shareholders-meeting.entity.ts`
- `shareholders-meeting-translation.entity.ts`
- `shareholders-meeting.types.ts`

### 3. ElectronicDisclosure (전자공시)

**파일 위치**: `src/domain/core/electronic-disclosure/`

```typescript
interface ElectronicDisclosureEntity extends BaseEntity {
  isPublic: boolean;
  status: ElectronicDisclosureStatus;
  order: number; // 정렬 순서
  // categories는 CategoryMapping 중간 테이블로 관리
  // translations는 ElectronicDisclosureTranslation 테이블로 관리
}

// 언어별 번역
interface ElectronicDisclosureTranslationEntity extends BaseEntity {
  electronicDisclosureId: string; // ElectronicDisclosure 엔티티 참조
  languageId: string; // Language 엔티티 참조
  title: string;
  description: string; // 간단한 설명
}
```

### 4. IR (투자자 관계)

**파일 위치**: `src/domain/core/ir/`

```typescript
interface IREntity extends BaseEntity {
  isPublic: boolean;
  status: IRStatus;
  fileUrl?: string; // AWS S3 URL (IR 자료 파일)
  order: number; // 정렬 순서
  // categories는 CategoryMapping 중간 테이블로 관리
  // translations는 IRTranslation 테이블로 관리
}

// 언어별 번역
interface IRTranslationEntity extends BaseEntity {
  irId: string; // IR 엔티티 참조
  languageId: string; // Language 엔티티 참조
  title: string;
  description: string; // 간단한 설명
  content: string; // 상세 내용
}
```

### 5. Brochure (브로슈어)

**파일 위치**: `src/domain/core/brochure/`

```typescript
interface BrochureEntity extends BaseEntity {
  isPublic: boolean;
  status: BrochureStatus;
  fileUrl?: string; // AWS S3 URL (브로슈어 파일)
  order: number; // 정렬 순서
  // categories는 CategoryMapping 중간 테이블로 관리
  // translations는 BrochureTranslation 테이블로 관리
}

// 언어별 번역
interface BrochureTranslationEntity extends BaseEntity {
  brochureId: string; // Brochure 엔티티 참조
  languageId: string; // Language 엔티티 참조
  title: string;
  description: string; // 간단한 설명
}
```

### 6. News (뉴스)

**파일 위치**: `src/domain/core/news/`

```typescript
interface NewsEntity extends BaseEntity {
  title: string;
  content: string;
  url: string; // 외부 링크 또는 상세 페이지 URL
  isPublic: boolean;
  status: NewsStatus;
  order: number; // 정렬 순서
  // categories는 CategoryMapping 중간 테이블로 관리
}
```

**구현 파일**:

- `news.entity.ts` - TypeORM Entity
- `news.types.ts` - DTO 타입 정의
- `news.service.ts` - Domain Service
- `news.module.ts` - NestJS Module

### 7. Announcement (공지사항)

**파일 위치**: `src/domain/core/announcement/`

`````typescript
// 공지사항 받은 직원 정보
// 생성 시점: 공지사항 생성 시 permissionEmployeeIds에 해당하는 모든 직원 레코드 자동 생성
interface AnnouncementEmployeeEntity extends BaseEntity {
  announcementId: string; // Announcement 엔티티 참조
  employeeId: string; // 외부 시스템 직원 ID (uuid)
  isRead: boolean;
  isSubmitted: boolean;
  submittedAt?: Date; // Date 타입
  readAt?: Date; // Date 타입
  responseMessage?: string;
  // 유니크 제약조건: (announcementId, employeeId) - 같은 직원이 같은 공지사항에 중복 레코드 불가
}

````typescript
interface AnnouncementEntity extends BaseEntity {
  title: string;
  content: string;
  isFixed: boolean; // 상단 고정 여부
  isPublic: boolean; // 공개 여부
  releasedAt?: Date; // Date 타입
  expiredAt?: Date; // Date 타입
  mustRead: boolean; // 필독 여부
  status: AnnouncementStatus;
  hits: number; // 조회수
  permissionEmployeeIds: string[]; // 권한 있는 직원 ID 목록 (SSO)
  order: number; // 정렬 순서
  // categories는 CategoryMapping 중간 테이블로 관리
  // attachments는 Attachment 테이블로 관리 (entityType = 'announcement')
}
`````

**구현 파일**:

- `announcement-employee.entity.ts` - 직원 응답 엔티티 (독립 테이블)
- `announcement-employee.types.ts` - 직원 응답 타입
- `announcement.entity.ts`
- `announcement.types.ts`

---

## Sub Domain (부가 기능)

### 1. LumirStory (루미르 스토리)

**파일 위치**: `src/domain/sub/lumir-story/`

```typescript
interface LumirStoryEntity extends BaseEntity {
  title: string;
  content: string;
  imageUrl?: string; // AWS S3 URL (썸네일/대표 이미지, 선택적)
  isPublic: boolean;
  status: LumirStoryStatus;
  order: number; // 정렬 순서
  // categories는 CategoryMapping 중간 테이블로 관리
}
```

**구현 파일**:

- `lumir-story.entity.ts` - TypeORM Entity
- `lumir-story.types.ts` - DTO 타입 정의
- `lumir-story.service.ts` - Domain Service
- `lumir-story.module.ts` - NestJS Module

### 2. VideoGallery (비디오 갤러리)

**파일 위치**: `src/domain/sub/video-gallery/`

```typescript
interface VideoGalleryEntity extends BaseEntity {
  title: string;
  description: string;
  videoUrl: string; // AWS S3 URL 또는 외부 비디오 URL
  isPublic: boolean;
  status: VideoGalleryStatus;
  order: number; // 정렬 순서
  // categories는 CategoryMapping 중간 테이블로 관리
}
```

**구현 파일**:

- `video-gallery.entity.ts` - TypeORM Entity
- `video-gallery.types.ts` - DTO 타입 정의
- `video-gallery.service.ts` - Domain Service
- `video-gallery.module.ts` - NestJS Module

### 3. Survey (설문조사)

**파일 위치**: `src/domain/sub/survey/`

```typescript
// 질문 타입
enum InqueryType {
  SHORT_ANSWER = 'short_answer', // 단답형
  PARAGRAPH = 'paragraph', // 장문형
  MULTIPLE_CHOICE = 'multiple_choice', // 객관식
  DROPDOWN = 'dropdown', // 드롭다운
  CHECKBOXES = 'checkboxes', // 체크박스
  FILE_UPLOAD = 'file_upload', // 파일 업로드
  DATETIME = 'datetime', // 날짜/시간
  LINEAR_SCALE = 'linear_scale', // 선형 척도
  GRID_SCALE = 'grid_scale', // 그리드 척도
}

// 질문 응답 데이터
type InqueryResponseData =
  | string // 단답형, 장문형, 객관식, 드롭다운
  | string[] // 체크박스, 파일 업로드
  | number // 선형 척도
  | Record<string, string> // 그리드 (행-열 매핑)
  | Record<string, string[]>; // 체크박스 그리드

// 질문 폼 데이터
type InqueryFormData =
  | Map<string, string>
  | Map<string, string[]>
  | Map<string, number>
  | Map<string, Record<string, string>>
  | Map<string, Record<string, string[]>>;

// 설문 질문 (독립 테이블)
interface SurveyQuestionEntity extends BaseEntity {
  surveyId: string; // Survey 엔티티 참조
  title: string;
  type: InqueryType;
  form: InqueryFormData; // JSONB - 질문 폼 구조
  isRequired: boolean;
  order: number; // 질문 순서
}

// 설문 응답 (독립 테이블)
interface SurveyResponseEntity extends BaseEntity {
  surveyId: string; // Survey 엔티티 참조 (설문 완료 추적용)
  questionId: string; // SurveyQuestion 엔티티 참조
  employeeId: string; // 외부 시스템 직원 ID (uuid)
  response: InqueryResponseData; // JSONB - 응답 데이터
  submittedAt: Date; // 응답 제출 시각 (모든 질문 응답 완료 시 surveyId와 employeeId로 완료 여부 판단)
  // 유니크 제약조건: (questionId, employeeId) - 같은 직원이 같은 질문에 중복 응답 불가, 수정 가능
  // 설문 완료 여부: SELECT COUNT(*) FROM survey_response WHERE survey_id = ? AND employee_id = ? 와 survey_question 개수 비교
}

interface SurveyEntity extends BaseEntity {
  title: string;
  description: string;
  status: SurveyStatus;
  startDate?: Date; // 시작일
  endDate?: Date; // 종료일
  permissionEmployeeIds: string[]; // 권한 있는 직원 ID 목록 (SSO)
  order: number; // 정렬 순서
  // categories는 CategoryMapping 중간 테이블로 관리
}
```

**구현 파일**:

- `survey-question.entity.ts` - 설문 질문 엔티티 (독립 테이블)
- `survey-question.types.ts` - 설문 질문 타입
- `survey-response.entity.ts` - 설문 응답 엔티티 (독립 테이블)
- `survey-response.types.ts` - 설문 응답 타입
- `inquery.types.ts` - 질문 관련 공통 타입
- `survey.entity.ts`
- `survey.types.ts`

### 4. EducationManagement (교육 관리)

**파일 위치**: `src/domain/sub/education-management/`

````typescript
// 수강 직원 상태
enum AttendeeStatus {
  PENDING = 'pending', // 대기중
  IN_PROGRESS = 'in_progress', // 진행중
  COMPLETED = 'completed', // 완료
  OVERDUE = 'overdue', // 기한 초과
}

// 수강 직원
interface AttendeeEntity extends BaseEntity {
  educationManagementId: string; // EducationManagement 엔티티 참조
  employeeId: string; // 외부 시스템 직원 ID (uuid)
  status: AttendeeStatus;
  completedAt?: Date; // Date 타입
  // deadline은 EducationManagement.deadline을 사용
  // 유니크 제약조건: (educationManagementId, employeeId) - 같은 직원이 같은 교육에 중복 등록 불가
}

```typescript
interface EducationManagementEntity extends BaseEntity {
  title: string;
  content: string;
  isPublic: boolean;
  managerId: string; // 담당자 ID (외부 시스템 직원 ID - SSO, uuid)
  deadline: Date; // Date 타입
  order: number; // 정렬 순서
  // attachments는 Attachment 테이블로 관리 (entityType = 'education_management')
}
````

**구현 파일**:

- `attendee.entity.ts` - 수강 직원 엔티티 (독립 테이블)
- `attendee.types.ts` - 수강 직원 타입
- `education-management.entity.ts`
- `education-management.types.ts`

### 5. WikiFileSystem (위키 파일 시스템)

**파일 위치**: `src/domain/sub/wiki-file-system/`

```typescript
// 파일 시스템 타입
enum WikiFileSystemType {
  FOLDER = 'folder',
  FILE = 'file',
}

interface WikiFileSystemEntity extends BaseEntity {
  name: string;
  type: WikiFileSystemType;
  parentId: string | null; // 자기 참조 (부모 폴더)
  fileUrl?: string; // AWS S3 URL (파일용, 선택적)
  fileSize?: number; // 파일 크기 (bytes)
  mimeType?: string; // MIME 타입 (예: image/jpeg, application/pdf)
  isPublic: boolean;
  permissionEmployeeIds: string[]; // 권한 있는 직원 ID 목록 (SSO)
  order: number; // 정렬 순서
}
```

**파일 저장 방식**:

- **FOLDER**: 모든 파일 관련 필드는 null
- **FILE**: AWS S3에 업로드 후 `fileUrl`, `fileSize`, `mimeType` 저장

**구현 파일**:

- `wiki-file-system.entity.ts` - 파일 시스템 엔티티
- `wiki-file-system.types.ts` - 파일 시스템 타입
- `wiki-file-system.service.ts` - Domain Service
- `wiki-file-system.module.ts` - NestJS Module

### 6. PageView (페이지 조회 통계)

**파일 위치**: `src/domain/sub/page-view/`

```typescript
// 디바이스 타입
enum DeviceType {
  DESKTOP = 'desktop',
  MOBILE = 'mobile',
  TABLET = 'tablet',
}

// 페이지뷰 엔티티 타입 (통계 대상 엔티티)
enum PageViewEntityType {
  MAIN_POPUP = 'main_popup',
  SHAREHOLDERS_MEETING = 'shareholders_meeting',
  ANNOUNCEMENT = 'announcement',
  ELECTRONIC_DISCLOSURE = 'electronic_disclosure',
  IR = 'ir',
  BROCHURE = 'brochure',
  LUMIR_STORY = 'lumir_story',
  VIDEO_GALLERY = 'video_gallery',
  NEWS = 'news',
  SURVEY = 'survey',
  EDUCATION_MANAGEMENT = 'education_management',
  WIKI_FILE_SYSTEM = 'wiki_file_system',
}

interface PageViewEntity extends BaseEntity {
  // 사용자 정보
  employeeId?: string; // 외부 시스템 직원 ID (SSO) - 로그인 사용자
  sessionId: string; // 세션 ID (익명 사용자 추적)

  // 페이지 정보
  pageUrl: string; // 방문한 페이지 URL (예: /announcement/123)
  pageTitle?: string; // 페이지 제목
  referrerUrl?: string; // 이전 페이지 URL

  // 엔티티 참조 (선택적)
  entityType?: PageViewEntityType; // 페이지뷰 엔티티 타입
  entityId?: string; // 해당 엔티티의 ID

  // 방문 정보
  viewedAt: Date; // 방문 시각
  duration?: number; // 체류 시간 (초)

  // 기술 정보
  ipAddress?: string; // IP 주소
  userAgent?: string; // 브라우저/디바이스 정보
  deviceType?: DeviceType; // 디바이스 타입

  // 지리 정보 (선택적)
  country?: string; // 국가
  city?: string; // 도시
}
```

**구현 파일**:

- `page-view.entity.ts` - 페이지뷰 엔티티
- `page-view.types.ts` - 페이지뷰 타입
- `page-view.service.ts` - Domain Service
- `page-view.module.ts` - NestJS Module

---

## Interface Layer 구현

### REST API 구조

**예시**: `src/interface/announcement-popup/`

```
announcement-popup/
├── dto/
│   └── announcement-popup.dto.ts      # CreateDto, UpdateDto, ResponseDto
├── decorators/
│   └── announcement-popup.decorators.ts  # API 데코레이터 (Swagger)
├── announcement-popup.controller.ts   # REST 컨트롤러
├── announcement-popup.module.ts       # NestJS 모듈
└── index.ts
```

### API 엔드포인트 패턴

- `GET /api/{resource}` - 전체 조회
- `GET /api/{resource}/:id` - 단건 조회
- `POST /api/{resource}` - 생성
- `PUT /api/{resource}/:id` - 수정
- `DELETE /api/{resource}/:id` - 삭제 (Soft Delete)

---

## 데이터베이스 스키마

### 공통 필드 (모든 테이블)

- `id` (UUID, Primary Key)
- `created_at` (TIMESTAMP)
- `updated_at` (TIMESTAMP)
- `deleted_at` (TIMESTAMP, nullable) - Soft Delete
- `created_by` (VARCHAR, nullable)
- `updated_by` (VARCHAR, nullable)
- `version` (INTEGER) - 낙관적 락

### 날짜 타입

- 모든 날짜 필드는 TypeScript에서 `Date` 타입 사용
- 데이터베이스에서는 `TIMESTAMP` 또는 `DATE` 타입 사용

### JSONB 필드

- 각 도메인의 `categoryIds`는 통합 Category 테이블의 ID 배열을 참조 (Many-to-Many)
- `languageId`는 Language 테이블의 ID를 참조 (Foreign Key)
- 복잡한 JSON 데이터는 JSONB로 저장
- PostgreSQL의 JSONB 타입 활용

---

## 변경 사항 요약

1. **엔티티로 변경**:
   - `Language`: 타입에서 엔티티로 변경, 관리자가 직접 관리 가능
   - `Category`: 도메인별 독립 테이블에서 통합 테이블로 변경
   - 하나의 `Category` 테이블에서 `entityType` 필드로 도메인 구분
   - 모든 도메인 엔티티에서 `categoryIds` (JSONB 배열)로 다대다 관계 유지

2. **제거된 기능**:
   - `Tag` 관련 모든 기능 제거
   - 모든 엔티티에서 `tags` 필드 제거
   - `Employee` 객체 제거, 외부 시스템 ID 참조로 변경
   - `Wiki` 엔티티 제거, `WikiFileSystem`으로 통합

3. **타입 변경**:
   - 모든 날짜 필드: `string` → `Date`
   - 모든 직원 참조: `manager: Employee` → `managerId: string`
   - 모든 카테고리 참조: JSONB 배열 → `EntityCategory` 중간 테이블 (정규화된 다대다 관계)
   - 모든 첨부파일: `attachments: string[]` → `Attachment` 테이블 (1:N 관계)
   - `AnnouncementEmployee`: JSONB 배열 → 독립 테이블 (1:N 관계)
   - `Attendee`: JSONB 배열 → 독립 테이블 (1:N 관계)
   - `SurveyQuestion`: JSONB 배열 → 독립 테이블 (1:N 관계)
   - `SurveyResponse`: JSONB 중첩 → 독립 테이블 (1:N 관계)
   - `WikiFileSystem`: JSONB 중첩 구조 → 자기 참조 테이블

4. **추가된 엔티티**:
   - `AnnouncementEmployeeEntity`: 공지사항 직원 응답 관리
   - `AttendeeEntity`: 교육 수강 직원 관리
   - `WikiFileSystemEntity`: 파일/폴더 계층 구조
   - `AttachmentEntity`: 첨부파일 메타데이터 관리
   - `SurveyQuestionEntity`: 설문 질문 관리
   - `SurveyResponseEntity`: 설문 응답 관리
   - `VoteResultEntity`: 주주총회 의결 결과 관리
   - `CategoryMappingEntity`: 카테고리 매핑 중간 테이블 (다대다 관계)
   - 번역 엔티티: `MainPopupTranslation`, `ShareholdersMeetingTranslation`, `ElectronicDisclosureTranslation`, `IRTranslation`, `BrochureTranslation`, `VoteResultTranslation`

5. **추가된 필드**:
   - 모든 콘텐츠 엔티티에 `order` 필드 추가 (정렬 기능)
   - `WikiFileSystem`에 `order` 필드 추가 (파일/폴더 정렬)
   - `Announcement`, `Survey`, `WikiFileSystem`에 `permissionEmployeeIds` 필드 추가 (접근 권한 관리)
   - `BaseEntity`에 기본 포함: `id`, `createdAt`, `updatedAt`, `deletedAt`, `createdBy` (외부 시스템 직원 ID - SSO), `updatedBy` (외부 시스템 직원 ID - SSO), `version`

6. **구현 구조**:
   - 각 도메인별로 Entity, DTO, Service, Module 분리
   - Language는 공통 도메인으로 분리 (`src/domain/common/`)
   - Category는 공통 도메인으로 통합 관리 (`src/domain/common/category/`)
   - 공통 타입은 `src/domain/core/common/types/`에 중앙화
   - Interface Layer는 별도 폴더로 구성
   - 직원 정보는 외부 시스템에서 관리 (ID만 참조, SSO 연동)

---

**문서 업데이트**: 2026년 1월 6일  
**구현 버전**: v5.1  
**주요 변경**:

- Category 통합 테이블로 변경 (entityType으로 도메인 구분)
- CategoryMapping 중간 테이블 추가 (정규화된 다대다 관계)
- CategoryMapping의 entityType 추가 (성능 최적화용 비정규화 필드)
- 모든 콘텐츠 엔티티 및 WikiFileSystem에 order 필드 추가
- Language 엔티티화
- 다국어 지원: 언어별 번역 테이블 추가 (MainPopup, ShareholdersMeeting, VoteResult, ElectronicDisclosure, IR, Brochure)
- VoteResult 다국어 지원 추가 (VoteResultTranslation)
- ElectronicDisclosure, IR, Brochure Translation에 description, content 필드 추가
- 단일 언어 엔티티: Announcement, Survey, News, LumirStory, VideoGallery
- JSONB → 독립 테이블 분리 (AnnouncementEmployee, Attendee, VoteResult, SurveyQuestion, SurveyResponse, Attachment)
- VoteResult 독립 테이블로 분리 (주주총회당 여러 안건 지원)
- Wiki 제거, WikiFileSystem으로 통합 (AWS S3 저장 지원)
- WikiFileSystem content 필드 제거 (모든 파일은 AWS S3 저장)
- Tag 기능 제거
- Employee 외부 시스템 연동 (SSO)
- 설문조사 질문/응답 정규화
- 첨부파일 메타데이터 관리
- Announcement, Survey, WikiFileSystem에 권한 관리 필드 (permissionEmployeeIds)
- managerId, ownerId 필드 제거 (createdBy/updatedBy로 대체)
